アプリケーション概要
OCRファイル検証・削除ツールは、効率的な文書管理のために設計されたデスクトップアプリケーションです。指定されたフォルダ内のスキャン画像ファイルを自動的に検証・削除します。OCR（光学文字認識）を用いて、ID番号や氏名などの特定のキーワードが含まれる文書を識別します。本ツールは、高速なバッチ処理に最適化されており、正しく識別されたファイルを自動的に削除することで、文書の確認作業を効率化します。

使い方
1. キーワードの入力: キーワード欄に、検索したいID番号や氏名などの識別子を入力します。1行に1セットのキーワードを入力してください。このアプリケーションは、入力欄のいずれかの行に指定されたすべてのキーワードが1つの文書内で見つかった場合にのみ、そのファイルを削除します。

2. 処理の開始: 「処理を開始(S)」ボタンをクリックすると、OCRとファイル削除の処理が始まります。進行状況はプログレスバーで表示されます。処理が完了または中止されると、ダイアログボックスで通知されます。

3. 中止: 処理を途中で止めたい場合は、「中止」ボタンをクリックします。

4. フォルダを開く: 「フォルダを開く(O)」ボタンをクリックすると、現在選択されているフォルダがWindowsエクスプローラーで開きます。

5. 結果の確認: 処理が完了すると、キーワードが見つからなかったファイルはフォルダ内に残ります。また、ImageProcessLog.txtというログファイルが作成され、どのファイルが処理されたか、所要時間、最終結果（"Deleted"、"Kept"、"ERROR"など）が詳細に記録されます。

設定方法
本アプリケーションの設定は、ユーザーインターフェースと設定ファイルの2つの方法で調整できます。

1. ユーザーインターフェースの設定
これらの設定は、アプリケーションを終了する際に自動的に保存され、次回起動時に引き継がれます。
- フォルダのパス: アプリケーションは前回選択されたフォルダを記憶しています。別の場所にあるファイルを処理する場合にのみ、変更が必要です。
- 言語: 「言語」ドロップダウンメニューから、アプリケーションの表示言語を切り替えることができます。
- デバッグモード: 「debug」チェックボックスをオンにすると、デバッグモードが有効になります。このモードでは、処理中のフォルダ内にdebugというサブフォルダが作成され、中間画像やOCRのテキストファイルが保存されます。OCRの問題を調査したり、ocr_params.iniファイルを微調整したりする際に役立ちます。
- 情報: 「情報(A)...」ボタンをクリックすると、アプリケーションのバージョン番号、著作権、開発者情報などの詳細が表示されます。

2. 設定ファイル（ocr_params.ini）
OCRやシステムに関する高度な設定は、アプリケーションの起動ディレクトリにあるocr_params.iniファイルを編集してください。

英数字のみのID番号を扱う場合、Languagesを engに設定することを強く推奨します。eng+jpnのように日本語を含めると、数字が丸数字などで誤認識される可能性があるためです。

[OCR] セクション
- Languages: OCRの対象言語を指定します。例：eng+jpn（英語と日本語）、eng（英語のみ）、jpn（日本語のみ）。
- UserDefinedDpi: OCR処理のDPI（dots per inch）を設定します。推奨値は300です。
- PageSegMode: Tesseractがページをどのようにセグメント化するかを決定します。自動モードのAutoや、特定のレイアウト用のSingleBlockに設定できます。

[System] セクション
- MaxDegreeOfParallelism: OCR処理に使用するスレッド数を制御します。推奨値は4-8です。
- OpenMpThreads: Tesseract用のOpenMPスレッド数を指定します。MaxDegreeOfParallelismと同じ値を推奨します。
- SkewSkipThresholdDeg: 傾き補正を適用するための最小角度（度）です。軽微な傾きをスキップするために、0.2を推奨します。
- MadThresholdDeg: 傾き補正で投影プロファイルに切り替える際の中央絶対偏差（MAD）の閾値です。推奨値は0.8です。
より詳しい情報は、ocr_params.iniファイル内のコメントや例を参照してください。